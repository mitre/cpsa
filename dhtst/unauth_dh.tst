(herald unauth-dh (algebra diffie-hellman))

(comment "CPSA 4.3.1")
(comment "All input read from unauth_dh.scm")

(defprotocol unauth-dh diffie-hellman
  (defrole init
    (vars (a rndx) (b base) (n text))
    (trace (send (exp (gen) a)) (recv b) (send (enc n (exp b a)))
      (recv n))
    (uniq-orig n)
    (uniq-gen a))
  (defrole recv
    (vars (a rndx) (b base) (n text))
    (trace (recv b) (send (exp (gen) a)) (recv (enc n (exp b a)))
      (send n))
    (uniq-gen a))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false)))))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx))
  (defstrand init 4 (n n) (b b) (a a))
  (uniq-orig n)
  (uniq-gen a)
  (traces
    ((send (exp (gen) a)) (recv b) (send (enc n (exp b a))) (recv n)))
  (label 0)
  (unrealized (0 3))
  (origs (n (0 2)))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b b) (a a))
  (defstrand recv 4 (n n) (b (exp b (mul a (rec a-0)))) (a a-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 3) (0 3)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-strand recv 4) n (0 3) (enc n (exp b a)))
  (traces
    ((send (exp (gen) a)) (recv b) (send (enc n (exp b a))) (recv n))
    ((recv (exp b (mul a (rec a-0)))) (send (exp (gen) a-0))
      (recv (enc n (exp b a))) (send n)))
  (label 1)
  (parent 0)
  (unrealized (1 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx))
  (defstrand init 4 (n n) (b b) (a a))
  (deflistener (exp b a))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)))
  (uniq-orig n)
  (uniq-gen a)
  (operation nonce-test (added-listener (exp b a)) n (0 3)
    (enc n (exp b a)))
  (traces
    ((send (exp (gen) a)) (recv b) (send (enc n (exp b a))) (recv n))
    ((recv (exp b a)) (send (exp b a))))
  (label 2)
  (parent 0)
  (unrealized (1 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a)) (a a-0))
  (defstrand recv 4 (n n) (b (exp (gen) a-0)) (a a))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (displaced 2 0 init 1) (exp (gen) a-1) (1 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) a))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul a a-0)))) (send n)))
  (label 3)
  (parent 1)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (defstrand recv 4 (n n) (b (gen)) (a a-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (contracted (b (exp (gen) (mul (rec a) a-0))))
    (gen) (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (gen)) (send (exp (gen) a-0)) (recv (enc n (exp (gen) a-0)))
      (send n)))
  (label 4)
  (parent 1)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 0) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test (added-strand init 1) (exp (gen) a-1) (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((send (exp (gen) a-1))))
  (label 5)
  (parent 1)
  (unrealized (0 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand recv 2 (b b) (a a-1))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test (added-strand recv 2) (exp (gen) a-1) (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((recv b) (send (exp (gen) a-1))))
  (label 6)
  (parent 1)
  (unrealized (0 1))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt))
  (defstrand init 4 (n n) (b b) (a a))
  (defstrand recv 4 (n n) (b (exp b (mul a (rec a-0)))) (a a-0))
  (deflistener (cat (exp b (mul a (rec a-0) (rec w))) w))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 3) (0 3)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test
    (added-listener (cat (exp b (mul a (rec a-0) (rec w))) w))
    (exp b (mul a (rec a-0))) (1 0))
  (traces
    ((send (exp (gen) a)) (recv b) (send (enc n (exp b a))) (recv n))
    ((recv (exp b (mul a (rec a-0)))) (send (exp (gen) a-0))
      (recv (enc n (exp b a))) (send n))
    ((recv (cat (exp b (mul a (rec a-0) (rec w))) w))
      (send (cat (exp b (mul a (rec a-0) (rec w))) w))))
  (label 7)
  (parent 1)
  (unrealized (2 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (gen)) (a a))
  (deflistener (exp (gen) a))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)))
  (uniq-orig n)
  (uniq-gen a)
  (operation nonce-test (displaced 2 0 init 1) (exp (gen) a-0) (1 0))
  (traces
    ((send (exp (gen) a)) (recv (gen)) (send (enc n (exp (gen) a)))
      (recv n)) ((recv (exp (gen) a)) (send (exp (gen) a))))
  (label 8)
  (parent 2)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)))
  (uniq-orig n)
  (uniq-gen a)
  (operation nonce-test (contracted (b (exp (gen) (rec a)))) (gen)
    (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen))))
  (label 9)
  (parent 2)
  (unrealized (0 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)) ((2 0) (0 1)) ((2 0) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-strand init 1) (exp (gen) a-0) (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((send (exp (gen) a-0))))
  (label 10)
  (parent 2)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)) ((2 1) (0 1)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-strand recv 2) (exp (gen) a-0) (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv b) (send (exp (gen) a-0))))
  (label 11)
  (parent 2)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt))
  (defstrand init 4 (n n) (b b) (a a))
  (deflistener (exp b a))
  (deflistener (cat (exp b (mul a (rec w))) w))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (added-listener (cat (exp b (mul a (rec w))) w))
    (exp b a) (1 0))
  (traces
    ((send (exp (gen) a)) (recv b) (send (enc n (exp b a))) (recv n))
    ((recv (exp b a)) (send (exp b a)))
    ((recv (cat (exp b (mul a (rec w))) w))
      (send (cat (exp b (mul a (rec w))) w))))
  (label 12)
  (parent 2)
  (unrealized (2 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a)) (a a-0))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation generalization deleted (1 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) a))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n)))
  (label 13)
  (parent 3)
  (realized)
  (shape)
  (maps ((0) ((a a-0) (b (exp (gen) a)) (n n))))
  (origs (n (0 2))))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (defstrand recv 4 (n n) (b (gen)) (a a-0))
  (deflistener (cat (exp (gen) (rec a)) a-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-listener (cat (exp (gen) (rec a)) a-0))
    (exp (gen) (mul (rec a) a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (gen)) (send (exp (gen) a-0)) (recv (enc n (exp (gen) a-0)))
      (send n))
    ((recv (cat (exp (gen) (rec a)) a-0))
      (send (cat (exp (gen) (rec a)) a-0))))
  (label 14)
  (parent 4)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (defstrand recv 4 (n n) (b (gen)) (a a-0))
  (deflistener (cat (exp (gen) a-0) a))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-listener (cat (exp (gen) a-0) a))
    (exp (gen) (mul (rec a) a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (gen)) (send (exp (gen) a-0)) (recv (enc n (exp (gen) a-0)))
      (send n))
    ((recv (cat (exp (gen) a-0) a)) (send (cat (exp (gen) a-0) a))))
  (label 15)
  (parent 4)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand init 1 (a a-1))
  (deflistener (cat (exp (gen) (mul (rec a) a-0)) a-1))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 0) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) a-0)) a-1))
    (exp (gen) (mul (rec a) a-0 a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul (rec a) a-0)) a-1))
      (send (cat (exp (gen) (mul (rec a) a-0)) a-1))))
  (label 16)
  (parent 5)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand init 1 (a a-1))
  (deflistener (cat (exp (gen) (mul (rec a) a-1)) a-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 0) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) a-1)) a-0))
    (exp (gen) (mul (rec a) a-0 a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul (rec a) a-1)) a-0))
      (send (cat (exp (gen) (mul (rec a) a-1)) a-0))))
  (label 17)
  (parent 5)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand init 1 (a a-1))
  (deflistener (cat (exp (gen) (mul a-0 a-1)) a))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 0) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul a-0 a-1)) a))
    (exp (gen) (mul (rec a) a-0 a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul a-0 a-1)) a))
      (send (cat (exp (gen) (mul a-0 a-1)) a))))
  (label 18)
  (parent 5)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand recv 2 (b b) (a a-1))
  (deflistener (cat (exp (gen) (mul (rec a) a-0)) a-1))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) a-0)) a-1))
    (exp (gen) (mul (rec a) a-0 a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((recv b) (send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul (rec a) a-0)) a-1))
      (send (cat (exp (gen) (mul (rec a) a-0)) a-1))))
  (label 19)
  (parent 6)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand recv 2 (b b) (a a-1))
  (deflistener (cat (exp (gen) (mul (rec a) a-1)) a-0))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) a-1)) a-0))
    (exp (gen) (mul (rec a) a-0 a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((recv b) (send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul (rec a) a-1)) a-0))
      (send (cat (exp (gen) (mul (rec a) a-1)) a-0))))
  (label 20)
  (parent 6)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a-0))
  (defstrand recv 2 (b b) (a a-1))
  (deflistener (cat (exp (gen) (mul a-0 a-1)) a))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul a-0 a-1)) a))
    (exp (gen) (mul (rec a) a-0 a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 a-1)))
      (send (enc n (exp (gen) (mul a-0 a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 a-1)))) (send n))
    ((recv b) (send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul a-0 a-1)) a))
      (send (cat (exp (gen) (mul a-0 a-1)) a))))
  (label 21)
  (parent 6)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (defstrand recv 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 3 0 init 1) (exp (gen) a-1) (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a w)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0))) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 22)
  (parent 7)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 w))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) w)) (a a-0))
  (deflistener (cat (gen) w))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (contracted (b (exp (gen) (mul (rec a) a-0 w))))
    (gen) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 w)))
      (send (enc n (exp (gen) (mul a-0 w)))) (recv n))
    ((recv (exp (gen) w)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 w)))) (send n))
    ((recv (cat (gen) w)) (send (cat (gen) w))))
  (label 23)
  (parent 7)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 w a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul w a-1))) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-1) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 w a-1)))
      (send (enc n (exp (gen) (mul a-0 w a-1)))) (recv n))
    ((recv (exp (gen) (mul w a-1))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 w a-1)))) (send n))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((send (exp (gen) a-1))))
  (label 24)
  (parent 7)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 w a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul w a-1))) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand recv 2 (b b) (a a-1))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-1) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 w a-1)))
      (send (enc n (exp (gen) (mul a-0 w a-1)))) (recv n))
    ((recv (exp (gen) (mul w a-1))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 w a-1)))) (send n))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((recv b) (send (exp (gen) a-1))))
  (label 25)
  (parent 7)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (gen)) (a a))
  (uniq-orig n)
  (uniq-gen a)
  (operation generalization deleted (1 0))
  (traces
    ((send (exp (gen) a)) (recv (gen)) (send (enc n (exp (gen) a)))
      (recv n)))
  (label 26)
  (parent 8)
  (realized)
  (shape)
  (maps ((0) ((a a) (b (gen)) (n n))))
  (origs (n (0 2))))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (exp (gen) (mul (rec a) (rec w))) w))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) (rec w))) w))
    (exp (gen) (rec a)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (exp (gen) (mul (rec a) (rec w))) w))
      (send (cat (exp (gen) (mul (rec a) (rec w))) w))))
  (label 27)
  (parent 9)
  (unrealized (2 0))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) (rec a)) a-0))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-listener (cat (exp (gen) (rec a)) a-0))
    (exp (gen) (mul (rec a) a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) (rec a)) a-0))
      (send (cat (exp (gen) (rec a)) a-0))))
  (label 28)
  (parent 10)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-0) a))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 0) (1 0))
    ((2 0) (3 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-listener (cat (exp (gen) a-0) a))
    (exp (gen) (mul (rec a) a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) a)) (send (cat (exp (gen) a-0) a))))
  (label 29)
  (parent 10)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) (rec a)) a-0))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((2 1) (3 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-listener (cat (exp (gen) (rec a)) a-0))
    (exp (gen) (mul (rec a) a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) (rec a)) a-0))
      (send (cat (exp (gen) (rec a)) a-0))))
  (label 30)
  (parent 11)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-0) a))
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((2 1) (3 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (added-listener (cat (exp (gen) a-0) a))
    (exp (gen) (mul (rec a) a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) a)) (send (cat (exp (gen) a-0) a))))
  (label 31)
  (parent 11)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (exp (gen) (mul w a)))
  (deflistener (cat (exp (gen) a) w))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (displaced 3 0 init 1) (exp (gen) a-0) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul w a)))) (recv n))
    ((recv (exp (gen) (mul w a))) (send (exp (gen) (mul w a))))
    ((recv (cat (exp (gen) a) w)) (send (cat (exp (gen) a) w))))
  (label 32)
  (parent 12)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) w))) (a a))
  (deflistener (exp (gen) w))
  (deflistener (cat (gen) w))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (contracted (b (exp (gen) (mul (rec a) w))))
    (gen) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) w)))
      (send (enc n (exp (gen) w))) (recv n))
    ((recv (exp (gen) w)) (send (exp (gen) w)))
    ((recv (cat (gen) w)) (send (cat (gen) w))))
  (label 33)
  (parent 12)
  (unrealized (0 1))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) w a-0))) (a a))
  (deflistener (exp (gen) (mul w a-0)))
  (deflistener (cat (exp (gen) a-0) w))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-0) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) w a-0)))
      (send (enc n (exp (gen) (mul w a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0))) (send (exp (gen) (mul w a-0))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((send (exp (gen) a-0))))
  (label 34)
  (parent 12)
  (unrealized (0 1))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) w a-0))) (a a))
  (deflistener (exp (gen) (mul w a-0)))
  (deflistener (cat (exp (gen) a-0) w))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-0) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) w a-0)))
      (send (enc n (exp (gen) (mul w a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0))) (send (exp (gen) (mul w a-0))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((recv b) (send (exp (gen) a-0))))
  (label 35)
  (parent 12)
  (unrealized (0 1))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (1 0))
  (operation generalization deleted (1 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a w)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 36)
  (parent 22)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a)) (a a-0))
  (deflistener (cat (gen) a))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 3 1 recv 2) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a a-0)))) (send n))
    ((recv (cat (gen) a)) (send (cat (gen) a))))
  (label 37)
  (parent 23)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w w-0 expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 w))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) w)) (a a-0))
  (deflistener (cat (gen) w))
  (deflistener (cat (exp (gen) (mul (rec a) a-0 w (rec w-0))) w-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) a-0 w (rec w-0))) w-0))
    (exp (gen) (mul (rec a) a-0 w)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 w)))
      (send (enc n (exp (gen) (mul a-0 w)))) (recv n))
    ((recv (exp (gen) w)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 w)))) (send n))
    ((recv (cat (gen) w)) (send (cat (gen) w)))
    ((recv (cat (exp (gen) (mul (rec a) a-0 w (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec a) a-0 w (rec w-0))) w-0))))
  (label 38)
  (parent 23)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-1)) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a)) (a a-1))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0))))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (displaced 4 1 recv 2) (exp (gen) a-2) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-1))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a-1))
      (recv (enc n (exp (gen) (mul a a-1)))) (send n))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0))))
      (send (cat (exp (gen) a-0) (mul a (rec a-0)))))
    ((send (exp (gen) a-0))))
  (label 39)
  (parent 24)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w expt) (a-1 rndx) (w-0 expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 w a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul w a-1))) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand init 1 (a a-1))
  (deflistener (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 0) (2 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (added-listener
      (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))
    (exp (gen) (mul (rec a) a-0 w a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 w a-1)))
      (send (enc n (exp (gen) (mul a-0 w a-1)))) (recv n))
    ((recv (exp (gen) (mul w a-1))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 w a-1)))) (send n))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))))
  (label 40)
  (parent 24)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-1)) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) a)) (a a-1))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0))))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (displaced 4 1 recv 2) (exp (gen) a-2) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-1))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a-1))
      (recv (enc n (exp (gen) (mul a a-1)))) (send n))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0))))
      (send (cat (exp (gen) a-0) (mul a (rec a-0)))))
    ((recv b) (send (exp (gen) a-0))))
  (label 41)
  (parent 25)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt) (a-1 rndx) (w-0 expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0 w a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul w a-1))) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand recv 2 (b b) (a a-1))
  (deflistener (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (2 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (added-listener
      (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))
    (exp (gen) (mul (rec a) a-0 w a-1)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0 w a-1)))
      (send (enc n (exp (gen) (mul a-0 w a-1)))) (recv n))
    ((recv (exp (gen) (mul w a-1))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a-0 w a-1)))) (send n))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((recv b) (send (exp (gen) a-1)))
    ((recv (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec a) a-0 w a-1 (rec w-0))) w-0))))
  (label 42)
  (parent 25)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (exp (gen) a) (mul (rec a) (rec a))))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (displaced 3 0 init 1) (exp (gen) a-0) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (exp (gen) a) (mul (rec a) (rec a))))
      (send (cat (exp (gen) a) (mul (rec a) (rec a))))))
  (label 43)
  (parent 27)
  (unrealized (0 1) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (rec a)))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (contracted (a-0 a) (w (rec a))) (gen) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (rec a))) (send (cat (gen) (rec a)))))
  (label 44)
  (parent 27)
  (unrealized (0 1) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (0 1))
    ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-0) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
      (send (cat (exp (gen) a-0) (mul (rec a) (rec a-0)))))
    ((send (exp (gen) a-0))))
  (label 45)
  (parent 27)
  (unrealized (0 1) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (1 0)) ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-0) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
      (send (cat (exp (gen) a-0) (mul (rec a) (rec a-0)))))
    ((recv b) (send (exp (gen) a-0))))
  (label 46)
  (parent 27)
  (unrealized (0 1) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (cat (exp (gen) a) w))
  (precedes ((0 0) (1 0)) ((1 1) (0 3)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (1 0))
  (operation generalization deleted (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul w a)))) (recv n))
    ((recv (cat (exp (gen) a) w)) (send (cat (exp (gen) a) w))))
  (label 47)
  (parent 32)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) a)) (a a))
  (deflistener (exp (gen) (mul a a)))
  (deflistener (cat (gen) (mul a a)))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (displaced 3 0 init 1) (exp (gen) a-0) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a))
      (send (enc n (exp (gen) (mul a a)))) (recv n))
    ((recv (exp (gen) (mul a a))) (send (exp (gen) (mul a a))))
    ((recv (cat (gen) (mul a a))) (send (cat (gen) (mul a a)))))
  (label 48)
  (parent 33)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (gen)) (a a))
  (deflistener (exp (gen) a))
  (deflistener (cat (gen) a))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (contracted (a-0 a) (w a)) (gen) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (gen)) (send (enc n (exp (gen) a)))
      (recv n)) ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (gen) a)) (send (cat (gen) a))))
  (label 49)
  (parent 33)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a))
  (deflistener (exp (gen) (mul a a-0)))
  (deflistener (cat (gen) (mul a a-0)))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-0) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n))
    ((recv (exp (gen) (mul a a-0))) (send (exp (gen) (mul a a-0))))
    ((recv (cat (gen) (mul a a-0))) (send (cat (gen) (mul a a-0))))
    ((send (exp (gen) a-0))))
  (label 50)
  (parent 33)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a))
  (deflistener (exp (gen) (mul a a-0)))
  (deflistener (cat (gen) (mul a a-0)))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-0) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n))
    ((recv (exp (gen) (mul a a-0))) (send (exp (gen) (mul a a-0))))
    ((recv (cat (gen) (mul a a-0))) (send (cat (gen) (mul a a-0))))
    ((recv b) (send (exp (gen) a-0))))
  (label 51)
  (parent 33)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w w-0 expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) w))) (a a))
  (deflistener (exp (gen) w))
  (deflistener (cat (gen) w))
  (deflistener (cat (exp (gen) (mul (rec a) w (rec w-0))) w-0))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) w (rec w-0))) w-0))
    (exp (gen) (mul (rec a) w)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) w)))
      (send (enc n (exp (gen) w))) (recv n))
    ((recv (exp (gen) w)) (send (exp (gen) w)))
    ((recv (cat (gen) w)) (send (cat (gen) w)))
    ((recv (cat (exp (gen) (mul (rec a) w (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec a) w (rec w-0))) w-0))))
  (label 52)
  (parent 33)
  (unrealized (3 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a))
  (deflistener (exp (gen) (mul a a-0)))
  (deflistener (cat (exp (gen) a-0) a))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 4 3 init 1) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n))
    ((recv (exp (gen) (mul a a-0))) (send (exp (gen) (mul a a-0))))
    ((recv (cat (exp (gen) a-0) a)) (send (cat (exp (gen) a-0) a)))
    ((send (exp (gen) a-0))))
  (label 53)
  (parent 34)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a-0))
  (deflistener (exp (gen) (mul a-0 a-0)))
  (deflistener (cat (exp (gen) a) (mul (rec a) a-0 a-0)))
  (defstrand init 1 (a a))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 4 0 init 1) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a-0 a-0)))) (recv n))
    ((recv (exp (gen) (mul a-0 a-0))) (send (exp (gen) (mul a-0 a-0))))
    ((recv (cat (exp (gen) a) (mul (rec a) a-0 a-0)))
      (send (cat (exp (gen) a) (mul (rec a) a-0 a-0))))
    ((send (exp (gen) a))))
  (label 54)
  (parent 34)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (gen)) (a a))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0))))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test
    (contracted (a-1 a) (w (mul a (rec a-0))) (a-2 a-0)) (gen) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (gen)) (send (enc n (exp (gen) a)))
      (recv n)) ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0))))
      (send (cat (exp (gen) a-0) (mul a (rec a-0)))))
    ((send (exp (gen) a-0))))
  (label 55)
  (parent 34)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-1)) (a a))
  (deflistener (exp (gen) (mul a a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
  (defstrand init 1 (a a-0))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)) ((4 0) (0 1)) ((4 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-1))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) (mul a a-1))) (send (exp (gen) (mul a a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) a-1))))
    ((send (exp (gen) a-0))) ((send (exp (gen) a-1))))
  (label 56)
  (parent 34)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-1)) (a a))
  (deflistener (exp (gen) (mul a a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
  (defstrand init 1 (a a-0))
  (defstrand recv 2 (b b) (a a-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 0) (0 1))
    ((3 0) (2 0)) ((4 1) (0 1)) ((4 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-1))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) (mul a a-1))) (send (exp (gen) (mul a a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) a-1))))
    ((send (exp (gen) a-0))) ((recv b) (send (exp (gen) a-1))))
  (label 57)
  (parent 34)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx) (w-0 expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) w a-0))) (a a))
  (deflistener (exp (gen) (mul w a-0)))
  (deflistener (cat (exp (gen) a-0) w))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))
    (exp (gen) (mul (rec a) w a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) w a-0)))
      (send (enc n (exp (gen) (mul w a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0))) (send (exp (gen) (mul w a-0))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))))
  (label 58)
  (parent 34)
  (unrealized (4 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-1)) (a a))
  (deflistener (exp (gen) (mul a a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
  (defstrand recv 2 (b b) (a a-0))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)) ((4 0) (0 1)) ((4 0) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-1))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) (mul a a-1))) (send (exp (gen) (mul a a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) a-1))))
    ((recv b) (send (exp (gen) a-0))) ((send (exp (gen) a-1))))
  (label 59)
  (parent 35)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a-0))
  (deflistener (exp (gen) (mul a-0 a-0)))
  (deflistener (cat (exp (gen) a) (mul (rec a) a-0 a-0)))
  (defstrand recv 2 (b b) (a a))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 4 0 init 1) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a-0 a-0)))) (recv n))
    ((recv (exp (gen) (mul a-0 a-0))) (send (exp (gen) (mul a-0 a-0))))
    ((recv (cat (exp (gen) a) (mul (rec a) a-0 a-0)))
      (send (cat (exp (gen) a) (mul (rec a) a-0 a-0))))
    ((recv b) (send (exp (gen) a))))
  (label 60)
  (parent 35)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (gen)) (a a))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0))))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test
    (contracted (a-1 a) (w (mul a (rec a-0))) (a-2 a-0)) (gen) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (gen)) (send (enc n (exp (gen) a)))
      (recv n)) ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0))))
      (send (cat (exp (gen) a-0) (mul a (rec a-0)))))
    ((recv b) (send (exp (gen) a-0))))
  (label 61)
  (parent 35)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-0)) (a a))
  (deflistener (exp (gen) (mul a a-0)))
  (deflistener (cat (exp (gen) a-0) a))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 4 3 recv 2) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a a-0)))) (recv n))
    ((recv (exp (gen) (mul a a-0))) (send (exp (gen) (mul a a-0))))
    ((recv (cat (exp (gen) a-0) a)) (send (cat (exp (gen) a-0) a)))
    ((recv b) (send (exp (gen) a-0))))
  (label 62)
  (parent 35)
  (unrealized (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b b-0 base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) a-1)) (a a))
  (deflistener (exp (gen) (mul a a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
  (defstrand recv 2 (b b) (a a-0))
  (defstrand recv 2 (b b-0) (a a-1))
  (precedes ((0 0) (2 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (0 1))
    ((3 1) (2 0)) ((4 1) (0 1)) ((4 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-1) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a-1))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) (mul a a-1))) (send (exp (gen) (mul a a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) a-1))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv b-0) (send (exp (gen) a-1))))
  (label 63)
  (parent 35)
  (unrealized (1 0) (2 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt) (a-0 rndx) (w-0 expt))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) w a-0))) (a a))
  (deflistener (exp (gen) (mul w a-0)))
  (deflistener (cat (exp (gen) a-0) w))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))
    (exp (gen) (mul (rec a) w a-0)) (0 1))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) w a-0)))
      (send (enc n (exp (gen) (mul w a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0))) (send (exp (gen) (mul w a-0))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec a) w a-0 (rec w-0))) w-0))))
  (label 64)
  (parent 35)
  (unrealized (4 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (1 0))
  (operation generalization deleted (1 1))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a w)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (cat (exp (gen) a-0) w))))
  (label 65)
  (parent 36)
  (realized)
  (shape)
  (maps ((0) ((a a-0) (b (exp (gen) (mul a w))) (n n))))
  (origs (n (0 2))))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (gen) (mul a w)))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (displaced 4 1 recv 2) (exp (gen) a-1) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((recv (cat (gen) (mul a w))) (send (cat (gen) (mul a w))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 66)
  (parent 38)
  (unrealized (2 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-1))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 0) (2 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 1 recv 2) (exp (gen) a-2) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-1)))
      (send (enc n (exp (gen) (mul a w a-1)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-1))
      (recv (enc n (exp (gen) (mul a w a-1)))) (send n))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w))))
    ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w))))
  (label 67)
  (parent 40)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-1))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-1))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (2 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 1 recv 2) (exp (gen) a-2) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-1)))
      (send (enc n (exp (gen) (mul a w a-1)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-1))
      (recv (enc n (exp (gen) (mul a w a-1)))) (send n))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w))))
  (label 68)
  (parent 42)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (exp (gen) a) (mul (rec a) (rec a))))
  (deflistener a)
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (added-listener a) (mul (rec a) (rec a)) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (exp (gen) a) (mul (rec a) (rec a))))
      (send (cat (exp (gen) a) (mul (rec a) (rec a)))))
    ((recv a) (send a)))
  (label 69)
  (parent 43)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (rec a)))
  (deflistener a)
  (precedes ((0 0) (1 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (0 1))
    ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (added-listener a) (rec a) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (rec a))) (send (cat (gen) (rec a))))
    ((recv a) (send a)))
  (label 70)
  (parent 44)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (uniq-orig n)
  (uniq-gen a)
  (operation generalization deleted (1 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul w a)))) (recv n)))
  (label 71)
  (parent 47)
  (realized)
  (shape)
  (maps ((0) ((a a) (b (exp (gen) w)) (n n))))
  (origs (n (0 2))))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) a)) (a a))
  (deflistener (exp (gen) (mul a a)))
  (deflistener (cat (gen) (mul a a)))
  (deflistener a)
  (precedes ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0)) ((3 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (added-listener a) (mul a a) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) a))
      (send (enc n (exp (gen) (mul a a)))) (recv n))
    ((recv (exp (gen) (mul a a))) (send (exp (gen) (mul a a))))
    ((recv (cat (gen) (mul a a))) (send (cat (gen) (mul a a))))
    ((recv a) (send a)))
  (label 72)
  (parent 48)
  (unrealized (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a))) (a a))
  (deflistener (exp (gen) (mul w a a)))
  (deflistener (cat (gen) (mul w a a)))
  (deflistener (cat (exp (gen) a) w))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (displaced 4 0 init 1) (exp (gen) a-0) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a)))
      (send (enc n (exp (gen) (mul w a a)))) (recv n))
    ((recv (exp (gen) (mul w a a))) (send (exp (gen) (mul w a a))))
    ((recv (cat (gen) (mul w a a))) (send (cat (gen) (mul w a a))))
    ((recv (cat (exp (gen) a) w)) (send (cat (exp (gen) a) w))))
  (label 73)
  (parent 52)
  (unrealized (1 0) (2 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (exp (gen) (mul a w)))
  (deflistener (cat (gen) (mul a w)))
  (deflistener (cat (gen) w))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (contracted (a-0 a) (w-0 (mul a w)) (w-1 w))
    (gen) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul a w)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) (mul a w))))
    ((recv (cat (gen) (mul a w))) (send (cat (gen) (mul a w))))
    ((recv (cat (gen) w)) (send (cat (gen) w))))
  (label 74)
  (parent 52)
  (unrealized (2 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (exp (gen) (mul a w a-0)))
  (deflistener (cat (gen) (mul a w a-0)))
  (deflistener (cat (exp (gen) a-0) w))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 0) (2 0)) ((4 0) (3 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-0) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w a-0))) (send (exp (gen) (mul a w a-0))))
    ((recv (cat (gen) (mul a w a-0))) (send (cat (gen) (mul a w a-0))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((send (exp (gen) a-0))))
  (label 75)
  (parent 52)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (gen) a))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (precedes ((0 0) (2 0)) ((1 1) (3 0)) ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (displaced 4 1 recv 2) (exp (gen) a) (3 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (gen) a)) (send (cat (gen) a)))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))))
  (label 76)
  (parent 52)
  (unrealized (0 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (exp (gen) (mul a w a-0)))
  (deflistener (cat (gen) (mul a w a-0)))
  (deflistener (cat (exp (gen) a-0) w))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (2 0)) ((4 1) (3 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-0) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w a-0))) (send (exp (gen) (mul a w a-0))))
    ((recv (cat (gen) (mul a w a-0))) (send (cat (gen) (mul a w a-0))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((recv b) (send (exp (gen) a-0))))
  (label 77)
  (parent 52)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (exp (gen) (mul a w a-0)))
  (deflistener (cat (exp (gen) a-0) (mul a w)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 3 init 1) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w a-0))) (send (exp (gen) (mul a w a-0))))
    ((recv (cat (exp (gen) a-0) (mul a w)))
      (send (cat (exp (gen) a-0) (mul a w)))) ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 78)
  (parent 58)
  (unrealized (1 0) (2 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a-0))
  (deflistener (exp (gen) (mul w a-0 a-0)))
  (deflistener (cat (exp (gen) a) (mul (rec a) w a-0 a-0)))
  (defstrand init 1 (a a))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 0 init 1) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul w a-0 a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0 a-0)))
      (send (exp (gen) (mul w a-0 a-0))))
    ((recv (cat (exp (gen) a) (mul (rec a) w a-0 a-0)))
      (send (cat (exp (gen) a) (mul (rec a) w a-0 a-0))))
    ((send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 79)
  (parent 58)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (exp (gen) (mul a w)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (gen) w))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-1 a) (w-0 (mul a (rec a-0) w)) (a-2 a-0) (w-1 w))
    (gen) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul a w)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) (mul a w))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w))))
    ((send (exp (gen) a-0)))
    ((recv (cat (gen) w)) (send (cat (gen) w))))
  (label 80)
  (parent 58)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-1))) (a a))
  (deflistener (exp (gen) (mul a w a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)) ((5 0) (2 0))
    ((5 0) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-1)))
      (send (enc n (exp (gen) (mul a w a-1)))) (recv n))
    ((recv (exp (gen) (mul a w a-1))) (send (exp (gen) (mul a w a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w a-1))))
    ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((send (exp (gen) a-1))))
  (label 81)
  (parent 58)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a-0 (rec a-1)))) (a a-1))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a) (mul (rec a) a-0)))
  (defstrand init 1 (a a))
  (deflistener (cat (exp (gen) a-0) (rec a-1)))
  (precedes ((0 0) (2 0)) ((1 1) (4 0)) ((2 1) (1 0)) ((3 0) (2 0))
    ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 1 recv 2) (exp (gen) a-0) (4 0))
  (traces
    ((send (exp (gen) a-1)) (recv (exp (gen) (mul a-0 (rec a-1))))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a) (mul (rec a) a-0)))
      (send (cat (exp (gen) a) (mul (rec a) a-0))))
    ((send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (rec a-1)))
      (send (cat (exp (gen) a-0) (rec a-1)))))
  (label 82)
  (parent 58)
  (unrealized (0 1) (2 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-1))) (a a))
  (deflistener (exp (gen) (mul a w a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand recv 2 (b b) (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)) ((5 1) (2 0))
    ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-1)))
      (send (enc n (exp (gen) (mul a w a-1)))) (recv n))
    ((recv (exp (gen) (mul a w a-1))) (send (exp (gen) (mul a w a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w a-1))))
    ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((recv b) (send (exp (gen) a-1))))
  (label 83)
  (parent 58)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-1))) (a a))
  (deflistener (exp (gen) (mul a w a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)) ((5 0) (2 0))
    ((5 0) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (added-strand init 1) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-1)))
      (send (enc n (exp (gen) (mul a w a-1)))) (recv n))
    ((recv (exp (gen) (mul a w a-1))) (send (exp (gen) (mul a w a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w a-1))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((send (exp (gen) a-1))))
  (label 84)
  (parent 64)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a-0))
  (deflistener (exp (gen) (mul w a-0 a-0)))
  (deflistener (cat (exp (gen) a) (mul (rec a) w a-0 a-0)))
  (defstrand recv 2 (b b) (a a))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 0 init 1) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul w a-0 a-0)))) (recv n))
    ((recv (exp (gen) (mul w a-0 a-0)))
      (send (exp (gen) (mul w a-0 a-0))))
    ((recv (cat (exp (gen) a) (mul (rec a) w a-0 a-0)))
      (send (cat (exp (gen) a) (mul (rec a) w a-0 a-0))))
    ((recv b) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 85)
  (parent 64)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (exp (gen) (mul a w)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (gen) w))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-1 a) (w-0 (mul a (rec a-0) w)) (a-2 a-0) (w-1 w))
    (gen) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul a w)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) (mul a w))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (gen) w)) (send (cat (gen) w))))
  (label 86)
  (parent 64)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a-0 (rec a-1)))) (a a-1))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a) (mul (rec a) a-0)))
  (defstrand recv 2 (b b) (a a))
  (deflistener (cat (exp (gen) a-0) (rec a-1)))
  (precedes ((0 0) (2 0)) ((1 1) (4 0)) ((2 1) (1 0)) ((3 1) (2 0))
    ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 1 recv 2) (exp (gen) a-0) (4 0))
  (traces
    ((send (exp (gen) a-1)) (recv (exp (gen) (mul a-0 (rec a-1))))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a) (mul (rec a) a-0)))
      (send (cat (exp (gen) a) (mul (rec a) a-0))))
    ((recv b) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (rec a-1)))
      (send (cat (exp (gen) a-0) (rec a-1)))))
  (label 87)
  (parent 64)
  (unrealized (0 1) (2 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (exp (gen) (mul a w a-0)))
  (deflistener (cat (exp (gen) a-0) (mul a w)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (displaced 5 3 recv 2) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w a-0))) (send (exp (gen) (mul a w a-0))))
    ((recv (cat (exp (gen) a-0) (mul a w)))
      (send (cat (exp (gen) a-0) (mul a w))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 88)
  (parent 64)
  (unrealized (1 0) (2 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b b-0 base) (a a-0 rndx) (w expt) (a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-1))) (a a))
  (deflistener (exp (gen) (mul a w a-1)))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-1) w))
  (defstrand recv 2 (b b-0) (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)) ((5 1) (2 0))
    ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (added-strand recv 2) (exp (gen) a-1) (4 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-1)))
      (send (enc n (exp (gen) (mul a w a-1)))) (recv n))
    ((recv (exp (gen) (mul a w a-1))) (send (exp (gen) (mul a w a-1))))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) w a-1)))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) w a-1))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) w)) (send (cat (exp (gen) a-1) w)))
    ((recv b-0) (send (exp (gen) a-1))))
  (label 89)
  (parent 64)
  (unrealized (1 0) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (defstrand recv 4 (n n) (b (gen)) (a a))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (contracted (a-1 a-0) (w (rec a-0))) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (gen)) (send (exp (gen) a)) (recv (enc n (exp (gen) a)))
      (send n)) ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))))
  (label 90)
  (parent 66)
  (unrealized (0 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (gen) (mul a w)))
  (deflistener (cat (exp (gen) a-0) w))
  (deflistener a)
  (precedes ((0 0) (4 0)) ((0 2) (1 2)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (0 1)) ((4 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a) (mul a w) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((recv (cat (gen) (mul a w))) (send (cat (gen) (mul a w))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((recv a) (send a)))
  (label 91)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0) a-1))) (a a-0))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a))
  (deflistener (cat (exp (gen) a-1) (one)))
  (defstrand init 1 (a a-1))
  (deflistener (cat (exp (gen) a) (mul (rec a-0) a-1)))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 0) (2 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-2 a-0) (a-3 a-1) (w (mul (rec a-0) a-1))) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0) a-1)))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul a a-1)))) (send n))
    ((recv (cat (exp (gen) a-1) (one)))
      (send (cat (exp (gen) a-1) (one)))) ((send (exp (gen) a-1)))
    ((recv (cat (exp (gen) a) (mul (rec a-0) a-1)))
      (send (cat (exp (gen) a) (mul (rec a-0) a-1)))))
  (label 92)
  (parent 67)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0) a-1))) (a a-0))
  (defstrand recv 4 (n n) (b (exp (gen) a-1)) (a a))
  (deflistener (cat (exp (gen) a-1) (one)))
  (defstrand recv 2 (b b) (a a-1))
  (deflistener (cat (exp (gen) a) (mul (rec a-0) a-1)))
  (precedes ((0 0) (2 0)) ((0 2) (1 2)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 0)) ((3 1) (2 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-2 a-0) (a-3 a-1) (w (mul (rec a-0) a-1))) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0) a-1)))
      (send (enc n (exp (gen) (mul a a-1)))) (recv n))
    ((recv (exp (gen) a-1)) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul a a-1)))) (send n))
    ((recv (cat (exp (gen) a-1) (one)))
      (send (cat (exp (gen) a-1) (one))))
    ((recv b) (send (exp (gen) a-1)))
    ((recv (cat (exp (gen) a) (mul (rec a-0) a-1)))
      (send (cat (exp (gen) a) (mul (rec a-0) a-1)))))
  (label 93)
  (parent 68)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (exp (gen) a) (mul (rec a) (rec a))))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (contracted (w (mul (rec a) (rec a))) (a-0 a))
    (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (exp (gen) a) (mul (rec a) (rec a))))
      (send (cat (exp (gen) a) (mul (rec a) (rec a))))))
  (label 94)
  (parent 73)
  (unrealized (0 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a))) (a a))
  (deflistener (exp (gen) (mul w a a)))
  (deflistener (cat (gen) (mul w a a)))
  (deflistener (cat (exp (gen) a) w))
  (deflistener a)
  (precedes ((0 0) (3 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a) (mul w a a) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a)))
      (send (enc n (exp (gen) (mul w a a)))) (recv n))
    ((recv (exp (gen) (mul w a a))) (send (exp (gen) (mul w a a))))
    ((recv (cat (gen) (mul w a a))) (send (cat (gen) (mul w a a))))
    ((recv (cat (exp (gen) a) w)) (send (cat (exp (gen) a) w)))
    ((recv a) (send a)))
  (label 95)
  (parent 73)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (gen) (rec a)))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (contracted (a-0 a) (w (rec a))) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (gen) (rec a))) (send (cat (gen) (rec a)))))
  (label 96)
  (parent 74)
  (unrealized (0 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt))
  (defstrand init 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (exp (gen) (mul a w)))
  (deflistener (cat (gen) (mul a w)))
  (deflistener (cat (gen) w))
  (deflistener a)
  (precedes ((0 0) (3 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a) (mul a w) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) w))
      (send (enc n (exp (gen) (mul a w)))) (recv n))
    ((recv (exp (gen) (mul a w))) (send (exp (gen) (mul a w))))
    ((recv (cat (gen) (mul a w))) (send (cat (gen) (mul a w))))
    ((recv (cat (gen) w)) (send (cat (gen) w))) ((recv a) (send a)))
  (label 97)
  (parent 74)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
  (defstrand init 1 (a a-0))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 0) (2 0)) ((4 0) (3 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test
    (contracted (a-1 a) (w (mul (rec a) (rec a-0))) (a-2 a-0)) (one)
    (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
      (send (cat (exp (gen) a-0) (mul (rec a) (rec a-0)))))
    ((send (exp (gen) a-0))))
  (label 98)
  (parent 75)
  (unrealized (0 1) (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (gen) a))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (deflistener a-0)
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (3 0)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (3 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a-0) (rec a-0) (3 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (gen) a)) (send (cat (gen) a)))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))) ((recv a-0) (send a-0)))
  (label 99)
  (parent 76)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
  (defstrand recv 2 (b b) (a a-0))
  (precedes ((0 0) (2 0)) ((0 0) (3 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (2 0)) ((4 1) (3 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test
    (contracted (a-1 a) (w (mul (rec a) (rec a-0))) (a-2 a-0)) (one)
    (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (exp (gen) a-0) (mul (rec a) (rec a-0))))
      (send (cat (exp (gen) a-0) (mul (rec a) (rec a-0)))))
    ((recv b) (send (exp (gen) a-0))))
  (label 100)
  (parent 77)
  (unrealized (0 1) (3 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a) (one)))
  (defstrand init 1 (a a))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (contracted (a-1 a-0) (w (rec a-0))) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (one))) (send (cat (exp (gen) a) (one))))
    ((send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))))
  (label 101)
  (parent 78)
  (unrealized (0 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (exp (gen) (mul a w a-0)))
  (deflistener (cat (exp (gen) a-0) (mul a w)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (deflistener a)
  (precedes ((0 0) (4 0)) ((0 0) (5 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)) ((5 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (added-listener a) (mul a w) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w a-0))) (send (exp (gen) (mul a w a-0))))
    ((recv (cat (exp (gen) a-0) (mul a w)))
      (send (cat (exp (gen) a-0) (mul a w)))) ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((recv a) (send a)))
  (label 102)
  (parent 78)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a) (one)))
  (defstrand init 1 (a a))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) (rec a-0))))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-1 a) (w (mul a (rec a-0) (rec a-0))) (a-2 a-0)) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (one))) (send (cat (exp (gen) a) (one))))
    ((send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) (rec a-0))))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) (rec a-0))))))
  (label 103)
  (parent 79)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a-0) (one)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (gen) (mul (rec a) a-0)))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-1 a) (a-2 a-0) (w (mul (rec a) a-0))) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) (one)))
      (send (cat (exp (gen) a-0) (one)))) ((send (exp (gen) a-0)))
    ((recv (cat (gen) (mul (rec a) a-0)))
      (send (cat (gen) (mul (rec a) a-0)))))
  (label 104)
  (parent 80)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a-0) (one)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)) ((5 0) (2 0))
    ((5 0) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-2 a) (a-3 a-0) (w (mul (rec a) a-0 (rec a-1)))
      (a-4 a-1)) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) (one)))
      (send (cat (exp (gen) a-0) (one)))) ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
      (send (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1)))))
    ((send (exp (gen) a-1))))
  (label 105)
  (parent 81)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a-0 (rec a-1)))) (a a-1))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a) (mul (rec a) a-0)))
  (defstrand init 1 (a a))
  (deflistener (cat (exp (gen) a-0) (rec a-1)))
  (deflistener a-1)
  (precedes ((0 0) (2 0)) ((0 0) (5 0)) ((1 1) (4 0)) ((2 1) (1 0))
    ((3 0) (2 0)) ((4 1) (0 1)) ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (added-listener a-1) (rec a-1) (4 0))
  (traces
    ((send (exp (gen) a-1)) (recv (exp (gen) (mul a-0 (rec a-1))))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a) (mul (rec a) a-0)))
      (send (cat (exp (gen) a) (mul (rec a) a-0))))
    ((send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (rec a-1)))
      (send (cat (exp (gen) a-0) (rec a-1)))) ((recv a-1) (send a-1)))
  (label 106)
  (parent 82)
  (unrealized (2 0) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a-0) (one)))
  (defstrand init 1 (a a-0))
  (deflistener (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
  (defstrand recv 2 (b b) (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)) ((5 1) (2 0))
    ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-2 a) (a-3 a-0) (w (mul (rec a) a-0 (rec a-1)))
      (a-4 a-1)) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) (one)))
      (send (cat (exp (gen) a-0) (one)))) ((send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
      (send (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1)))))
    ((recv b) (send (exp (gen) a-1))))
  (label 107)
  (parent 83)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a-0) (one)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
  (defstrand init 1 (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)) ((5 0) (2 0))
    ((5 0) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-2 a) (a-3 a-0) (w (mul (rec a) a-0 (rec a-1)))
      (a-4 a-1)) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) (one)))
      (send (cat (exp (gen) a-0) (one))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
      (send (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1)))))
    ((send (exp (gen) a-1))))
  (label 108)
  (parent 84)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a) (one)))
  (defstrand recv 2 (b b) (a a))
  (deflistener (cat (exp (gen) a-0) (mul a (rec a-0) (rec a-0))))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-1 a) (w (mul a (rec a-0) (rec a-0))) (a-2 a-0)) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (one))) (send (cat (exp (gen) a) (one))))
    ((recv b) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (mul a (rec a-0) (rec a-0))))
      (send (cat (exp (gen) a-0) (mul a (rec a-0) (rec a-0))))))
  (label 109)
  (parent 85)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a-0) (one)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (gen) (mul (rec a) a-0)))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-1 a) (a-2 a-0) (w (mul (rec a) a-0))) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) (one)))
      (send (cat (exp (gen) a-0) (one))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (gen) (mul (rec a) a-0)))
      (send (cat (gen) (mul (rec a) a-0)))))
  (label 110)
  (parent 86)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a-0 (rec a-1)))) (a a-1))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a) (mul (rec a) a-0)))
  (defstrand recv 2 (b b) (a a))
  (deflistener (cat (exp (gen) a-0) (rec a-1)))
  (deflistener a-1)
  (precedes ((0 0) (2 0)) ((0 0) (5 0)) ((1 1) (4 0)) ((2 1) (1 0))
    ((3 1) (2 0)) ((4 1) (0 1)) ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test (added-listener a-1) (rec a-1) (4 0))
  (traces
    ((send (exp (gen) a-1)) (recv (exp (gen) (mul a-0 (rec a-1))))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a) (mul (rec a) a-0)))
      (send (cat (exp (gen) a) (mul (rec a) a-0))))
    ((recv b) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a-0) (rec a-1)))
      (send (cat (exp (gen) a-0) (rec a-1)))) ((recv a-1) (send a-1)))
  (label 111)
  (parent 87)
  (unrealized (2 0) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a) (one)))
  (defstrand recv 2 (b b) (a a))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (contracted (a-1 a-0) (w (rec a-0))) (one)
    (2 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (one))) (send (cat (exp (gen) a) (one))))
    ((recv b) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))))
  (label 112)
  (parent 88)
  (unrealized (0 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt) (a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (exp (gen) (mul a w a-0)))
  (deflistener (cat (exp (gen) a-0) (mul a w)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (deflistener a)
  (precedes ((0 0) (4 0)) ((0 0) (5 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)) ((5 1) (2 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (added-listener a) (mul a w) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))) (recv n))
    ((recv (exp (gen) (mul a w a-0))) (send (exp (gen) (mul a w a-0))))
    ((recv (cat (exp (gen) a-0) (mul a w)))
      (send (cat (exp (gen) a-0) (mul a w))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w)))
    ((recv a) (send a)))
  (label 113)
  (parent 88)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b b-0 base) (a a-0 a-1 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul (rec a) a-0))) (a a))
  (deflistener (exp (gen) a-0))
  (deflistener (cat (exp (gen) a-0) (one)))
  (defstrand recv 2 (b b) (a a-0))
  (deflistener (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
  (defstrand recv 2 (b b-0) (a a-1))
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)) ((5 1) (2 0))
    ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0 a-1)
  (precur (2 0) (4 0))
  (operation nonce-test
    (contracted (a-2 a) (a-3 a-0) (w (mul (rec a) a-0 (rec a-1)))
      (a-4 a-1)) (one) (2 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (mul (rec a) a-0)))
      (send (enc n (exp (gen) a-0))) (recv n))
    ((recv (exp (gen) a-0)) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-0) (one)))
      (send (cat (exp (gen) a-0) (one))))
    ((recv b) (send (exp (gen) a-0)))
    ((recv (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1))))
      (send (cat (exp (gen) a-1) (mul (rec a) a-0 (rec a-1)))))
    ((recv b-0) (send (exp (gen) a-1))))
  (label 114)
  (parent 89)
  (unrealized (0 1) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (defstrand recv 4 (n n) (b (gen)) (a a))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (deflistener a-0)
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((0 2) (1 2)) ((1 1) (3 0))
    ((1 3) (0 3)) ((2 1) (1 0)) ((3 1) (0 1)) ((4 1) (3 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a-0) (rec a-0) (3 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (gen)) (send (exp (gen) a)) (recv (enc n (exp (gen) a)))
      (send n)) ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))) ((recv a-0) (send a-0)))
  (label 115)
  (parent 90)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (exp (gen) a) (mul (rec a) (rec a))))
  (deflistener a)
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (3 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a) (mul (rec a) (rec a)) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (exp (gen) a) (mul (rec a) (rec a))))
      (send (cat (exp (gen) a) (mul (rec a) (rec a)))))
    ((recv a) (send a)))
  (label 116)
  (parent 94)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand init 4 (n n) (b (exp (gen) (rec a))) (a a))
  (deflistener (gen))
  (deflistener (cat (gen) (one)))
  (deflistener (cat (gen) (rec a)))
  (deflistener a)
  (precedes ((0 0) (2 0)) ((0 0) (4 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (0 1)) ((4 1) (3 0)))
  (uniq-orig n)
  (uniq-gen a)
  (precur (2 0) (3 0))
  (operation nonce-test (added-listener a) (rec a) (3 0))
  (traces
    ((send (exp (gen) a)) (recv (exp (gen) (rec a)))
      (send (enc n (gen))) (recv n)) ((recv (gen)) (send (gen)))
    ((recv (cat (gen) (one))) (send (cat (gen) (one))))
    ((recv (cat (gen) (rec a))) (send (cat (gen) (rec a))))
    ((recv a) (send a)))
  (label 117)
  (parent 96)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a) (one)))
  (defstrand init 1 (a a))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (deflistener a-0)
  (precedes ((0 0) (2 0)) ((0 0) (5 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 0) (2 0)) ((3 0) (4 0)) ((4 1) (0 1)) ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (added-listener a-0) (rec a-0) (4 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (one))) (send (cat (exp (gen) a) (one))))
    ((send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))) ((recv a-0) (send a-0)))
  (label 118)
  (parent 101)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand init 4 (n n) (b (exp (gen) (mul a (rec a-0)))) (a a-0))
  (deflistener (exp (gen) a))
  (deflistener (cat (exp (gen) a) (one)))
  (defstrand recv 2 (b b) (a a))
  (deflistener (cat (exp (gen) a) (rec a-0)))
  (deflistener a-0)
  (precedes ((0 0) (2 0)) ((0 0) (5 0)) ((1 1) (0 3)) ((2 1) (1 0))
    ((3 1) (2 0)) ((3 1) (4 0)) ((4 1) (0 1)) ((5 1) (4 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0) (4 0))
  (operation nonce-test (added-listener a-0) (rec a-0) (4 0))
  (traces
    ((send (exp (gen) a-0)) (recv (exp (gen) (mul a (rec a-0))))
      (send (enc n (exp (gen) a))) (recv n))
    ((recv (exp (gen) a)) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (one))) (send (cat (exp (gen) a) (one))))
    ((recv b) (send (exp (gen) a)))
    ((recv (cat (exp (gen) a) (rec a-0)))
      (send (cat (exp (gen) a) (rec a-0)))) ((recv a-0) (send a-0)))
  (label 119)
  (parent 112)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol unauth-dh diffie-hellman
  (defrole init
    (vars (a rndx) (b base) (n text))
    (trace (send (exp (gen) a)) (recv b) (send (enc n (exp b a)))
      (recv n))
    (uniq-orig n)
    (uniq-gen a))
  (defrole recv
    (vars (a rndx) (b base) (n text))
    (trace (recv b) (send (exp (gen) a)) (recv (enc n (exp b a)))
      (send n))
    (uniq-gen a))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false)))))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx))
  (defstrand recv 4 (n n) (b b) (a a))
  (uniq-gen a)
  (traces
    ((recv b) (send (exp (gen) a)) (recv (enc n (exp b a))) (send n)))
  (label 120)
  (unrealized (0 2))
  (origs)
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx))
  (defstrand recv 4 (n n) (b b) (a a))
  (defstrand init 3 (n n) (b (exp b (mul a (rec a-0)))) (a a-0))
  (precedes ((0 1) (1 1)) ((1 2) (0 2)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation encryption-test (added-strand init 3) (enc n (exp b a))
    (0 2))
  (traces
    ((recv b) (send (exp (gen) a)) (recv (enc n (exp b a))) (send n))
    ((send (exp (gen) a-0)) (recv (exp b (mul a (rec a-0))))
      (send (enc n (exp b a)))))
  (label 121)
  (parent 120)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx))
  (defstrand recv 4 (n n) (b b) (a a))
  (deflistener (exp b a))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (uniq-gen a)
  (operation encryption-test (added-listener (exp b a))
    (enc n (exp b a)) (0 2))
  (traces
    ((recv b) (send (exp (gen) a)) (recv (enc n (exp b a))) (send n))
    ((recv (exp b a)) (send (exp b a))))
  (label 122)
  (parent 120)
  (unrealized (1 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) a)) (a a-0))
  (defstrand init 3 (n n) (b (exp (gen) a-0)) (a a))
  (precedes ((0 1) (1 1)) ((1 0) (0 0)) ((1 2) (0 2)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation nonce-test (displaced 2 0 recv 2) (exp (gen) a-1) (1 1))
  (traces
    ((recv (exp (gen) a)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a a-0)))) (send n))
    ((send (exp (gen) a)) (recv (exp (gen) a-0))
      (send (enc n (exp (gen) (mul a a-0))))))
  (label 123)
  (parent 121)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a a-0 rndx) (w expt))
  (defstrand recv 4 (n n) (b b) (a a))
  (defstrand init 3 (n n) (b (exp b (mul a (rec a-0)))) (a a-0))
  (deflistener (cat (exp b (mul a (rec a-0) (rec w))) w))
  (precedes ((0 1) (2 0)) ((1 0) (2 0)) ((1 2) (0 2)) ((2 1) (1 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test
    (added-listener (cat (exp b (mul a (rec a-0) (rec w))) w))
    (exp b (mul a (rec a-0))) (1 1))
  (traces
    ((recv b) (send (exp (gen) a)) (recv (enc n (exp b a))) (send n))
    ((send (exp (gen) a-0)) (recv (exp b (mul a (rec a-0))))
      (send (enc n (exp b a))))
    ((recv (cat (exp b (mul a (rec a-0) (rec w))) w))
      (send (cat (exp b (mul a (rec a-0) (rec w))) w))))
  (label 124)
  (parent 121)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand recv 4 (n n) (b (gen)) (a a))
  (deflistener (exp (gen) a))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (uniq-gen a)
  (operation nonce-test (displaced 2 0 recv 2) (exp (gen) a-0) (1 0))
  (traces
    ((recv (gen)) (send (exp (gen) a)) (recv (enc n (exp (gen) a)))
      (send n)) ((recv (exp (gen) a)) (send (exp (gen) a))))
  (label 125)
  (parent 122)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (b base) (a rndx) (w expt))
  (defstrand recv 4 (n n) (b b) (a a))
  (deflistener (exp b a))
  (deflistener (cat (exp b (mul a (rec w))) w))
  (precedes ((0 1) (2 0)) ((1 1) (0 2)) ((2 1) (1 0)))
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (added-listener (cat (exp b (mul a (rec w))) w))
    (exp b a) (1 0))
  (traces
    ((recv b) (send (exp (gen) a)) (recv (enc n (exp b a))) (send n))
    ((recv (exp b a)) (send (exp b a)))
    ((recv (cat (exp b (mul a (rec w))) w))
      (send (cat (exp b (mul a (rec w))) w))))
  (label 126)
  (parent 122)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) a)) (a a-0))
  (uniq-orig n)
  (uniq-gen a a-0)
  (operation generalization deleted (1 0))
  (traces
    ((recv (exp (gen) a)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a a-0)))) (send n)))
  (label 127)
  (parent 123)
  (realized)
  (origs)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (defstrand init 3 (n n) (b (exp (gen) (mul w a-0))) (a a))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 1) (2 0)) ((1 0) (0 0)) ((1 2) (0 2)) ((2 1) (1 1)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (2 0))
  (operation nonce-test (displaced 3 0 recv 2) (exp (gen) a-1) (2 0))
  (traces
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((send (exp (gen) a)) (recv (exp (gen) (mul w a-0)))
      (send (enc n (exp (gen) (mul a w a-0)))))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 128)
  (parent 124)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx))
  (defstrand recv 4 (n n) (b (gen)) (a a))
  (uniq-gen a)
  (operation generalization deleted (1 0))
  (traces
    ((recv (gen)) (send (exp (gen) a)) (recv (enc n (exp (gen) a)))
      (send n)))
  (label 129)
  (parent 125)
  (realized)
  (shape)
  (maps ((0) ((a a) (b (gen)) (n n))))
  (origs))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand recv 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (exp (gen) (mul w a)))
  (deflistener (cat (exp (gen) a) w))
  (precedes ((0 1) (2 0)) ((1 1) (0 2)) ((2 1) (1 0)))
  (uniq-gen a)
  (precur (2 0))
  (operation nonce-test (displaced 3 0 recv 2) (exp (gen) a-0) (2 0))
  (traces
    ((recv (exp (gen) w)) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul w a)))) (send n))
    ((recv (exp (gen) (mul w a))) (send (exp (gen) (mul w a))))
    ((recv (cat (exp (gen) a) w)) (send (cat (exp (gen) a) w))))
  (label 130)
  (parent 126)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) a)) (a a-0))
  (uniq-gen a a-0)
  (operation generalization forgot n)
  (traces
    ((recv (exp (gen) a)) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a a-0)))) (send n)))
  (label 131)
  (parent 127)
  (realized)
  (shape)
  (maps ((0) ((a a-0) (b (exp (gen) a)) (n n))))
  (origs))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (1 0))
  (operation generalization deleted (1 0))
  (traces
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((recv (cat (exp (gen) a-0) w)) (send (cat (exp (gen) a-0) w))))
  (label 132)
  (parent 128)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand recv 4 (n n) (b (exp (gen) w)) (a a))
  (deflistener (cat (exp (gen) a) w))
  (precedes ((0 1) (1 0)) ((1 1) (0 2)))
  (uniq-gen a)
  (precur (1 0))
  (operation generalization deleted (1 0))
  (traces
    ((recv (exp (gen) w)) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul w a)))) (send n))
    ((recv (cat (exp (gen) a) w)) (send (cat (exp (gen) a) w))))
  (label 133)
  (parent 130)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 1) (1 0)))
  (uniq-orig n)
  (uniq-gen a a-0)
  (precur (1 0))
  (operation generalization deleted (1 1))
  (traces
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((recv (cat (exp (gen) a-0) w))))
  (label 134)
  (parent 132)
  (realized)
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton unauth-dh
  (vars (n text) (w expt) (a rndx))
  (defstrand recv 4 (n n) (b (exp (gen) w)) (a a))
  (uniq-gen a)
  (operation generalization deleted (1 0))
  (traces
    ((recv (exp (gen) w)) (send (exp (gen) a))
      (recv (enc n (exp (gen) (mul w a)))) (send n)))
  (label 135)
  (parent 133)
  (realized)
  (shape)
  (maps ((0) ((a a) (b (exp (gen) w)) (n n))))
  (origs))

(defskeleton unauth-dh
  (vars (n text) (a rndx) (w expt) (a-0 rndx))
  (defstrand recv 4 (n n) (b (exp (gen) (mul a w))) (a a-0))
  (deflistener (cat (exp (gen) a-0) w))
  (precedes ((0 1) (1 0)))
  (uniq-gen a a-0)
  (precur (1 0))
  (operation generalization forgot n)
  (traces
    ((recv (exp (gen) (mul a w))) (send (exp (gen) a-0))
      (recv (enc n (exp (gen) (mul a w a-0)))) (send n))
    ((recv (cat (exp (gen) a-0) w))))
  (label 136)
  (parent 134)
  (realized)
  (shape)
  (maps ((0) ((a a-0) (b (exp (gen) (mul a w))) (n n))))
  (origs))

(comment "Nothing left to do")
